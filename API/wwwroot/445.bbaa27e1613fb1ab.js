"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[445],{5445:(O,p,i)=>{i.r(p),i.d(p,{AdminModule:()=>J});var c=i(6895),e=i(1571),f=i(9479),u=i(9241),d=i(388),m=i(433);function b(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",10)(1,"input",11),e.NdJ("change",function(){const r=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.updateChecked(r))}),e.qZA(),e.TgZ(2,"label"),e._uU(3),e.qZA()()}if(2&n){const t=s.$implicit,o=e.oxw();e.xp6(1),e.Q6J("checked",o.selectedRoles.includes(t))("disabled","Admin"===t&&"admin@test.com"===o.username),e.xp6(2),e.Oqu(t)}}let v=(()=>{class n{constructor(t){this.bsModalRef=t,this.username="",this.availableRoles=[],this.selectedRoles=[]}updateChecked(t){const o=this.selectedRoles.indexOf(t);-1!==o?this.selectedRoles.splice(o,1):this.selectedRoles.push(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(d.UZ))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-roles-modal"]],decls:13,vars:2,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],["id","rolesForm"],["rolesForm","ngForm"],["class","form-check",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-default",3,"click"],[1,"form-check"],["type","checkbox","value","role",1,"form-check-input",3,"checked","disabled","change"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h4",1),e._uU(2),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return o.bsModalRef.hide()}),e.TgZ(4,"span",3),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",4)(7,"form",5,6),e.YNc(9,b,4,3,"div",7),e.qZA()(),e.TgZ(10,"div",8)(11,"button",9),e.NdJ("click",function(){return o.bsModalRef.hide()}),e._uU(12,"Submit"),e.qZA()()),2&t&&(e.xp6(2),e.hij("Edit Roles for ",o.username,""),e.xp6(7),e.Q6J("ngForOf",o.availableRoles))},dependencies:[c.sg,m._Y,m.JL,m.F]}),n})();var _=i(2340),A=i(529);let h=(()=>{class n{constructor(t){this.http=t,this.baseUrl=_.N.apiUrl}getUsersWithRoles(){return this.http.get(this.baseUrl+"admin/users-with-roles")}updateUserRoles(t,o){return this.http.post(this.baseUrl+"admin/edit-roles/"+t+"?roles="+o,{})}getPhotosForApproval(){return this.http.get(this.baseUrl+"admin/photos-to-moderate")}approvePhoto(t){return this.http.post(this.baseUrl+"admin/approve-photo/"+t,{})}rejectPhoto(t){return this.http.post(this.baseUrl+"admin/reject-photo/"+t,{})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(A.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function C(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td")(6,"button",5),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.openRolesModal(r))}),e._uU(7,"Edit Roles"),e.qZA()()()}if(2&n){const t=s.$implicit;e.xp6(2),e.Oqu(t.displayName),e.xp6(2),e.Oqu(t.roles)}}let M=(()=>{class n{constructor(t,o){this.adminService=t,this.modalService=o,this.users=[],this.bsModalRef=new d.UZ,this.availableRoles=["Admin","Moderator","Member"]}ngOnInit(){this.getUsersWithRoles()}getUsersWithRoles(){this.adminService.getUsersWithRoles().subscribe({next:t=>{this.users=t}})}openRolesModal(t){const o={class:"modal-dialog-centered",initialState:{username:t.username,availableRoles:this.availableRoles,selectedRoles:[...t.roles]}};this.bsModalRef=this.modalService.show(v,o),this.bsModalRef.onHide?.subscribe({next:()=>{const a=this.bsModalRef.content?.selectedRoles;this.arrayEqual(a,t.roles)||this.adminService.updateUserRoles(t.username,a).subscribe({next:r=>t.roles=r})}})}arrayEqual(t,o){return JSON.stringify(t.sort())===JSON.stringify(o.sort())}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(h),e.Y36(d.tT))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-user-management"]],decls:11,vars:1,consts:[[1,"row"],[1,"table"],[2,"width","30%"],[2,"width","40%"],[4,"ngFor","ngForOf"],[1,"btn","btn-info",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"table",1)(2,"thead")(3,"tr")(4,"th",2),e._uU(5,"Username"),e.qZA(),e.TgZ(6,"th",3),e._uU(7,"Active roles"),e.qZA(),e._UZ(8,"th",2),e.qZA()(),e.TgZ(9,"tbody"),e.YNc(10,C,8,2,"tr",4),e.qZA()()()),2&t&&(e.xp6(10),e.Q6J("ngForOf",o.users))},dependencies:[c.sg]}),n})();function Z(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",2)(1,"h4"),e._uU(2),e.qZA(),e._UZ(3,"img",3),e.TgZ(4,"div",4)(5,"button",5),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.approvePhoto(r.id))}),e._uU(6,"Approve"),e.qZA(),e.TgZ(7,"button",6),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.rejectPhoto(r.id))}),e._uU(8,"Reject"),e.qZA()()()}if(2&n){const t=s.$implicit;e.xp6(2),e.Oqu(t.username),e.xp6(1),e.s9C("src",t.url,e.LSH),e.s9C("alt",t.username)}}let x=(()=>{class n{constructor(t){this.adminService=t,this.photos=[]}ngOnInit(){this.getPhotosForApproval()}approvePhoto(t){this.adminService.approvePhoto(t).subscribe({next:()=>this.photos.splice(this.photos.findIndex(o=>o.id===t),1)})}rejectPhoto(t){this.adminService.rejectPhoto(t).subscribe({next:()=>this.photos.splice(this.photos.findIndex(o=>o.id===t),1)})}getPhotosForApproval(){this.adminService.getPhotosForApproval().subscribe({next:t=>this.photos=t})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(h))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-photo-management"]],decls:2,vars:1,consts:[[1,"row"],["class","col-sm-2",4,"ngFor","ngForOf"],[1,"col-sm-2"],[1,"img-thumbnail","p-1",3,"src","alt"],[1,"text-center"],[1,"btn","btn-sm","btn-success","me-1",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Z,9,3,"div",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngForOf",o.photos))},dependencies:[c.sg],styles:["img.img-thumbnail[_ngcontent-%COMP%]{height:175px;min-width:175px!important;margin-bottom:2px}"]}),n})();function R(n,s){1&n&&(e.TgZ(0,"tab",6)(1,"div",7),e._UZ(2,"app-user-management"),e.qZA()())}function U(n,s){1&n&&(e.TgZ(0,"tab",8)(1,"div",7),e._UZ(2,"app-photo-management"),e.qZA()())}function T(n,s){if(1&n&&(e.ynx(0),e.YNc(1,R,3,0,"tab",4),e.YNc(2,U,3,0,"tab",5),e.BQk()),2&n){const t=s.ngIf;e.xp6(1),e.Q6J("ngIf",t.roles.includes("Admin")),e.xp6(1),e.Q6J("ngIf",t.roles.includes("Moderator")||t.roles.includes("Admin"))}}let P=(()=>{class n{constructor(t){this.accountService=t}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(f.B))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-admin-panel"]],decls:7,vars:3,consts:[[1,"container","mt-3"],[1,"tab-panel"],[1,"member-tabset"],[4,"ngIf"],["heading","User Management",4,"ngIf"],["heading","Photo Management",4,"ngIf"],["heading","User Management"],[1,"container"],["heading","Photo Management"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h2"),e._uU(2,"Admin Panel"),e.qZA(),e.TgZ(3,"div",1)(4,"tabset",2),e.YNc(5,T,3,2,"ng-container",3),e.ALo(6,"async"),e.qZA()()()),2&t&&(e.xp6(5),e.Q6J("ngIf",e.lcZ(6,1,o.accountService.currentUser$)))},dependencies:[c.O5,u.wW,u.AH,M,x,c.Ov]}),n})();var g=i(9383);const y=[{path:"",component:P}];let F=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[g.Bz.forChild(y),g.Bz]}),n})();var S=i(4466);let J=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[c.ez,F,S.m]}),n})()}}]);